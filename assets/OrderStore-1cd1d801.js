import{u as g,x as s}from"./index-4827bd10.js";import{u as h,a as u}from"./ToastMessageStore-265c6617.js";const{VITE_API:d,VITE_API_PATH:i}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"benson-vue3",BASE_URL:"/forest-sea-patisserie/",MODE:"production",DEV:!1,PROD:!0},{pushMessage:n}=h(),{loadingState:o}=u(),P=g("orderStore",{state:()=>({order:{products:[],user:{address:"",email:"",name:"",tel:""}},orders:[],pagination:{},currentPage:1,ordersTotal:0,totalCategory:{},chartDataTotal:[],chartDataCategory:[],orderNotPaidNum:0}),actions:{getOrder(r){const t=`${d}/api/${i}/order/${r}`;s.get(t).then(e=>{this.order="",this.order=e.data.order}).catch(e=>{n({style:"danger",title:"取得訂單失敗，請稍後再試",content:`${e.response.data.message}`})})},getOrders(r=1){this.currentPage=r;const t=`${d}/api/${i}/admin/orders?page=${r}`;o(!0),s.get(t).then(e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,o(!1),this.getLastOrdersTotal(this.orders)}).catch(e=>{n({style:"danger",title:"取得訂單資料失敗",content:`${e.response.data.message}`}),o(!1)})},getLastOrdersTotal(r){const t=r.filter(e=>e.is_paid===!0);this.ordersTotal=t.reduce((e,a)=>e+a.total,0),this.chartDataTotal=t.map(e=>e.total)},getCategoryChartData(){this.orders.map(t=>t.products).forEach(t=>{Object.values(t).forEach(e=>{this.totalCategory[e.product.category]?this.totalCategory[e.product.category]+=1:this.totalCategory[e.product.category]=1})}),this.chartDataCategory=Object.entries(this.totalCategory)},getNotPaidOrders(){const r=this.orders.filter(t=>t.is_paid===!1);this.orderNotPaidNum=r.length},createDate(r){const t=new Date(r*1e3),e=t.getFullYear(),a=t.getMonth()+1>=10?t.getMonth()+1:`0${t.getMonth()+1}`,c=t.getDate()>=10?t.getDate():`0${t.getDate()}`;return`${e}/${a}/${c}`}}});export{P as u};
