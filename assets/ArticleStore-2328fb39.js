import{u,x as l}from"./index-c79f23f6.js";import{a as g,u as m}from"./ToastMessageStore-851a6cf0.js";const{VITE_API:c,VITE_API_PATH:n}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_API_PATH:"benson-vue3",BASE_URL:"/forest-sea-patisserie/",MODE:"production",DEV:!1,PROD:!0},{loadingState:s}=g(),{pushMessage:h}=m(),f=u("articleStore",{state:()=>({articles:[],article:{},currentNum:0,preNum:0,nextNum:0,nextArticle:{},preArticle:{},hasNext:null,hasPre:null,pagination:{},lastImage:""}),getters:{filterLastArticles(){return this.articles.slice(0,3)}},actions:{getArticles(){const e=`${c}/api/${n}/articles`;s(!0),l.get(e).then(t=>{s(!1),this.articles=t.data.articles,this.pagination=t.data.pagination,this.getLastImage()}).catch(t=>{s(!1),h({style:"danger",title:"取得文章失敗，請稍後再試",content:`${t.response.data.message}`})})},getArticle(e){const t=`${c}/api/${n}/article/${e}`;s(!0),l.get(t).then(r=>{var i;s(!1),this.article=r.data.article;const a=this.articles.filter(o=>o.id===e);this.currentNum=(i=a[0])==null?void 0:i.num,this.getNextArticle(),this.getPreArticle()}).catch(r=>{s(!1),h({style:"danger",title:"取得文章失敗，請稍後再試",content:`${r.response}`})})},getNextArticle(){if(this.nextNum=this.currentNum+1,this.nextNum<=this.articles.length){const e=this.articles.filter(t=>t.num===this.nextNum);this.nextArticle=e[0],this.hasNext=!0}else this.hasNext=!1},getPreArticle(){if(this.preNum=this.currentNum-1,this.preNum){const e=this.articles.filter(t=>t.num===this.preNum);this.preArticle=e[0],this.hasPre=!0}else this.hasPre=!1},clearArticle(){this.article={}},getLastImage(){this.lastImage=this.articles[0].image},createDate(e){const t=new Date(e*1e3),r=t.getFullYear(),a=t.getMonth()+1>=10?t.getMonth()+1:`0${t.getMonth()+1}`,i=t.getDate()>=10?t.getDate():`0${t.getDate()}`;return`${r}/${a}/${i}`}}});export{f as u};
